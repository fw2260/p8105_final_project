---
title: "Final Report"
date: "11/23/2020"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
---

```{r setup, include=FALSE}
library(tidyverse)
library(patchwork)
library(ggpubr)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Motivation

## Initial Questions

For games run on consoles developed by Nintendo, Sony and Microsoft, we want to know separately:

* How does the sales of games change over time?

* What is the most popular/profitable game genre on each companies' consoles?

* Is there an association between critic scores and game sales? In which direction?

* Does the number of consoles the games are released on influence their sales?

## Data Collection

## Exploratory Analyses

### Question 1

```{r q1, message = FALSE}
games_df = read_csv("./data/games.csv")

totalsale = games_df %>% 
  group_by(release_year) %>% 
  summarize(
    totalsale = sum(total_sale)
  ) %>% 
  drop_na() %>% 
  ggplot(aes(x = release_year, y = totalsale)) +
  geom_col() +
  labs(x = "Year", y = "Total Sale (million USD)")

totalcount = games_df %>% 
 group_by(release_year) %>% 
  summarize(
    count = n()
  ) %>% 
  drop_na() %>% 
  ggplot(aes(x = release_year, y = count)) +
  geom_col() +
  labs(x = "Year", y = "Number of Games")


totalsale + totalcount
```

### Question 2

```{r q2}
games_df %>% 
  ggplot(aes(x = genre, y = total_sale, fill = console_developer)) +
  geom_bar(stat = "identity", position = "stack") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  labs(x = "Genre", y = "Total Sale (million USD)", fill = "Console Developer")
```

### Question 3

```{r q3, message = FALSE}
games_df %>% 
  filter(total_sale < 5) %>% 
  ggplot(aes(x = critic_score, y = total_sale, color = console_developer)) +
  geom_point(alpha = 0.2) +
  geom_smooth(method = 'lm', se = F) +
  labs(x = "Critic Score", y = "Total Sale (million USD)", color = "Console Developer")
```

### Question 4

```{r q4}
games_df %>% 
  mutate(n_platforms = as.factor(n_platforms)) %>% 
  ggplot(aes(x = n_platforms, y = total_sale, fill = console_developer)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(x = "Number of Platforms", y = "Total Sale (million USD)", fill = "Console Developer")
```


## Regression Model
 

